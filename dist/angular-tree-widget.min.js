/*
	@license Angular TreeWidget version 1.0.1
	ⓒ 2016 Alex Suleap https://github.com/AlexSuleap/agular-tree-widget
	License: MIT
*/
!function(e){"use strict";e.module("TreeWidget",["ngAnimate","RecursionHelper"]).directive("tree",function(){return{restrict:"E",scope:{nodes:"=",options:"=?"},template:"<treenode nodes='nodes' tree='nodelist' options='options'></treenode>",compile:function(e,n,o){return{pre:function(e){function n(o,d){if(void 0!=o&&o.length>0)for(var t=0;t<o.length;t++){var i=o[t];void 0===i.nodeId&&(i.nodeId="tree-node-"+e.count,e.count++),void 0===i.expanded&&void 0!=i.children&&(i.expanded=!0),void 0!=d&&(i.parentId=d.nodeId),-1==e.nodelist.indexOf(i)&&e.nodelist.push(i),n(i.children,i)}}e.nodelist=[],e.options=e.options||(e.options={showIcon:!0,expandOnClick:!1,multipleSelect:!1}),e.count=0,e.$watch(function(){n(e.nodes)})}}}}}).directive("treenode",["RecursionHelper",function(n){return{restrict:"E",scope:{nodes:"=",tree:"=",options:"=?"},template:'<ul><li ng-repeat="node in nodes" class="node"><i class="tree-node-ico pointer" ng-class="{\'tree-node-expanded\': node.expanded,\'tree-node-collapsed\':!node.expanded && node.children}" ng-click="toggleNode(node)"></i><span class="node-title pointer" ng-click="selectNode(node)" ng-class="{\'disabled\':node.disabled}"><span><i class="tree-node-ico" ng-if="options.showIcon" ng-class="{\'tree-node-image\':node.children, \'tree-node-leaf\':!node.children}" ng-style="node.image && {\'background-image\':\'url(\'+node.image+\')\'}"></i><span class="node-name" ng-class="{selected: node.selected&& !node.disabled}">{{node.name}}</span></span></span><treenode ng-if="node.children" nodes=\'node.children\' tree="tree" options="options" ng-show="node.expanded" id="{{node.nodeId}}"></treenode></li></ul>',compile:function(o){return n.compile(o,function(n,o,d,t,i){n.selectNode=function(o){if(!o.disabled){var d;n.options.multipleSelect?(o.selected=!o.selected,d=n.tree.filter(function(e){return e.selected})):(o.selected=!0,e.forEach(n.tree,function(e){o!=e&&(e.selected=!1)}),d=o),n.$emit("selection-changed",d),n.options.onSelectNode&&n.options.onSelectNode(d),n.options.expandOnClick&&void 0!=o.children&&(o.expanded=!o.expanded,n.$emit("expanded-state-changed",o),n.options.onExpandNode&&n.options.onExpandNode(o))}},n.toggleNode=function(e){void 0!=e.children&&(e.expanded=!e.expanded,n.$emit("expanded-state-changed",e),n.options.onExpandNode&&n.options.onExpandNode(e))}})}}}])}(angular);